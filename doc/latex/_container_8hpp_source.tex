\doxysection{Container.\+hpp}
\hypertarget{_container_8hpp_source}{}\label{_container_8hpp_source}\index{include/Container.hpp@{include/Container.hpp}}
\mbox{\hyperlink{_container_8hpp}{См. документацию.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifndef\ CONTAINER\_HPP}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ CONTAINER\_HPP}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_container_macros_8hpp}{ContainerMacros.hpp}}"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_descriptor_8hpp}{Descriptor.hpp}}"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_factory_8hpp}{Factory.hpp}}"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_memory_pool_8hpp}{MemoryPool.hpp}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_util_8hpp}{Util.hpp}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <cstddef>}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#ifndef\ KNOT\_MAX\_SERVICES}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#define\ KNOT\_MAX\_SERVICES\ 16}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#ifndef\ KNOT\_MAX\_TRANSIENTS}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#define\ KNOT\_MAX\_TRANSIENTS\ 32}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_knot}{Knot}}\ \{}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00034\ \textcolor{keyword}{class\ }Container\ \{}
\DoxyCodeLine{00035\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{class_knot_1_1_container_a19ca7c0dfa56bed3ac39afa878487edf}{Container}}(\textcolor{keyword}{const}\ Container\ \&);\ \textcolor{comment}{//\ Запрет\ копирования\ контейнера}}
\DoxyCodeLine{00037\ \ \ Container\ \&operator=(\textcolor{keyword}{const}\ Container\ \&);\ \textcolor{comment}{//\ Запрет\ присваивания\ контейнера}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \textcolor{keywordtype}{size\_t}\ \_service\_count;\ \textcolor{comment}{//\ Количество\ зарегистрированных\ сервисов}}
\DoxyCodeLine{00040\ \ \ \textcolor{keywordtype}{size\_t}\ \_transient\_count;\ \textcolor{comment}{//\ Количество\ временных\ сервисов}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \mbox{\hyperlink{class_knot_1_1_memory_pool}{MemoryPool}}\ \_pool;\ \textcolor{comment}{//\ Пул\ памяти\ для\ управления\ памятью\ сервисов}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \mbox{\hyperlink{struct_knot_1_1_registry_entry}{RegistryEntry}}\ \_registry[\mbox{\hyperlink{_container_8hpp_a96a9f28591acabb590052e6ff2e59d67}{KNOT\_MAX\_SERVICES}}];\ \textcolor{comment}{//\ Реестр\ зарегистрированных\ сервисов}}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{struct_knot_1_1_transient_info}{TransientInfo}}\ \_transients[\mbox{\hyperlink{_container_8hpp_a0be5eb622adb32a42af1bc9a30a6307b}{KNOT\_MAX\_TRANSIENTS}}];\ \textcolor{comment}{//\ Массив\ временных\ сервисов}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00051\ \ \ \mbox{\hyperlink{struct_knot_1_1_registry_entry}{RegistryEntry}}\ *find\_entry(\textcolor{keywordtype}{void}\ *tid)\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_service\_count;\ ++i)}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_registry[i].type\ ==\ tid)}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \&\_registry[i];}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00056\ \ \ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00063\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>\ \textcolor{keywordtype}{bool}\ register\_singleton(\mbox{\hyperlink{class_knot_1_1_i_factory}{IFactory}}\ *factory)\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ \textcolor{keyword}{sizeof}(T);}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordtype}{void}\ *mem\ =\ \_pool.allocate(size,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}\ *));}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordflow}{if}\ (!mem)}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00068\ \ \ \ \ \mbox{\hyperlink{struct_knot_1_1_registry_entry}{RegistryEntry}}\ \&entry\ =\ \_registry[\_service\_count++];}
\DoxyCodeLine{00069\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_a6a9c8eb7690bbfca4376fa2ceda12479}{type}}\ =\ \mbox{\hyperlink{namespace_knot_ade86e03f8ae9230191e43c78f1cfa78e}{TypeId<T>}}();}
\DoxyCodeLine{00070\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_ab71b1f88abdd60313b12275785647f7f}{desc}}.\mbox{\hyperlink{struct_knot_1_1_descriptor_a8efd47264e3428bfe225edfab3ec4cf7}{factory}}\ =\ factory;}
\DoxyCodeLine{00071\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_ab71b1f88abdd60313b12275785647f7f}{desc}}.\mbox{\hyperlink{struct_knot_1_1_descriptor_a4f391dbbe3f1c713360257fb10d5dfee}{strategy}}\ =\ \mbox{\hyperlink{_strategy_8hpp_acf7192c608527efb8f8dedf0a3f2e706a57da18394d2f90538c40b0b8d4a3a3c7}{SINGLETON}};}
\DoxyCodeLine{00072\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_ab71b1f88abdd60313b12275785647f7f}{desc}}.\mbox{\hyperlink{struct_knot_1_1_descriptor_a3553620e4356d57d1f294449b8ee3f95}{storage}}\ =\ mem;}
\DoxyCodeLine{00073\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_ab71b1f88abdd60313b12275785647f7f}{desc}}.\mbox{\hyperlink{struct_knot_1_1_descriptor_a6ff2348022d066f78bcb6dfcae995d10}{instance}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00075\ \ \ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00082\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>\ \textcolor{keywordtype}{bool}\ register\_transient(\mbox{\hyperlink{class_knot_1_1_i_factory}{IFactory}}\ *factory)\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \mbox{\hyperlink{struct_knot_1_1_registry_entry}{RegistryEntry}}\ \&entry\ =\ \_registry[\_service\_count++];}
\DoxyCodeLine{00084\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_a6a9c8eb7690bbfca4376fa2ceda12479}{type}}\ =\ \mbox{\hyperlink{namespace_knot_ade86e03f8ae9230191e43c78f1cfa78e}{TypeId<T>}}();}
\DoxyCodeLine{00085\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_ab71b1f88abdd60313b12275785647f7f}{desc}}.\mbox{\hyperlink{struct_knot_1_1_descriptor_a8efd47264e3428bfe225edfab3ec4cf7}{factory}}\ =\ factory;}
\DoxyCodeLine{00086\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_ab71b1f88abdd60313b12275785647f7f}{desc}}.\mbox{\hyperlink{struct_knot_1_1_descriptor_a4f391dbbe3f1c713360257fb10d5dfee}{strategy}}\ =\ \mbox{\hyperlink{_strategy_8hpp_acf7192c608527efb8f8dedf0a3f2e706a189628bd9c66ada3fb11593230091ad4}{TRANSIENT}};}
\DoxyCodeLine{00087\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_ab71b1f88abdd60313b12275785647f7f}{desc}}.\mbox{\hyperlink{struct_knot_1_1_descriptor_a3553620e4356d57d1f294449b8ee3f95}{storage}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00088\ \ \ \ \ entry.\mbox{\hyperlink{struct_knot_1_1_registry_entry_ab71b1f88abdd60313b12275785647f7f}{desc}}.\mbox{\hyperlink{struct_knot_1_1_descriptor_a6ff2348022d066f78bcb6dfcae995d10}{instance}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00100\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00101\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ addService(\mbox{\hyperlink{_strategy_8hpp_acf7192c608527efb8f8dedf0a3f2e706}{Strategy}}\ strategy,\ \mbox{\hyperlink{class_knot_1_1_i_factory}{IFactory}}\ *factory)\ \{}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{void}\ *tid\ =\ \mbox{\hyperlink{namespace_knot_ade86e03f8ae9230191e43c78f1cfa78e}{TypeId<T>}}();}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordflow}{if}\ (!factory\ ||\ \_service\_count\ >=\ \mbox{\hyperlink{_container_8hpp_a96a9f28591acabb590052e6ff2e59d67}{KNOT\_MAX\_SERVICES}}\ ||\ find\_entry(tid))}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordflow}{switch}\ (strategy)\ \{}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{_strategy_8hpp_acf7192c608527efb8f8dedf0a3f2e706a57da18394d2f90538c40b0b8d4a3a3c7}{SINGLETON}}:}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ register\_singleton<T>(factory);}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{_strategy_8hpp_acf7192c608527efb8f8dedf0a3f2e706a189628bd9c66ada3fb11593230091ad4}{TRANSIENT}}:}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ register\_transient<T>(factory);}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00114\ \ \ \ \ \}}
\DoxyCodeLine{00115\ \ \ \}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00124\ \ \ \mbox{\hyperlink{class_knot_1_1_container_a19ca7c0dfa56bed3ac39afa878487edf}{Container}}()\ :\ \_service\_count(0),\ \_transient\_count(0),\ \_pool(4096)\ \{\}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00132\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_knot_1_1_container_a551cabc40700aa939146c71d3dd81f44}{Container}}(\textcolor{keywordtype}{size\_t}\ max\_bytes)}
\DoxyCodeLine{00133\ \ \ \ \ \ \ :\ \_service\_count(0),\ \_transient\_count(0),\ \_pool(max\_bytes)\ \{\}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00142\ \ \ \mbox{\hyperlink{class_knot_1_1_container_a0e07a68d515c2f8bb1276f8a961ce960}{Container}}(\textcolor{keywordtype}{void}\ *buffer,\ \textcolor{keywordtype}{size\_t}\ buffer\_size)}
\DoxyCodeLine{00143\ \ \ \ \ \ \ :\ \_service\_count(0),\ \_transient\_count(0),\ \_pool(buffer,\ buffer\_size)\ \{\}}
\DoxyCodeLine{00144\ \ \ }
\DoxyCodeLine{00150\ \ \ \mbox{\hyperlink{class_knot_1_1_container_a0fbd32476f8f066f68d977d18af6bafd}{\string~Container}}()\ \{}
\DoxyCodeLine{00151\ \ \ \ \ \mbox{\hyperlink{class_knot_1_1_container_a38a66d665fe8f1fe4c3a5291d7a23d8b}{destroyAllTransients}}();}
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{class_knot_1_1_container_aacd6e366d6f1d452f1a0e41c671f020c}{destroyAllSingletons}}();}
\DoxyCodeLine{00153\ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00163\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_knot_1_1_container_a54aebbf7b4fcbf12f6bede3b4d132dae}{registerService}}(\mbox{\hyperlink{_strategy_8hpp_acf7192c608527efb8f8dedf0a3f2e706}{Strategy}}\ strategy)\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordflow}{return}\ addService<T>(strategy,\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_knot_1_1_factory}{Factory<T>}}());}
\DoxyCodeLine{00165\ \ \ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \mbox{\hyperlink{_container_macros_8hpp_a1de051757a89f3ee99e0eebd6214fd8e}{REGISTER\_GEN}}\ \textcolor{comment}{//\ Макрос\ для\ регистрации\ сервисов\ с\ различной\ арностью}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00177\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>\ T\ *\mbox{\hyperlink{class_knot_1_1_container_a9f2501e818ea2c32eaa827f89fc31e4a}{resolve}}()\ \{}
\DoxyCodeLine{00178\ \ \ \ \ KNOT\_INFO(\textcolor{stringliteral}{"{}Resolving\ service\ with\ ID:\ \{\}"{}},\ \mbox{\hyperlink{namespace_knot_ade86e03f8ae9230191e43c78f1cfa78e}{TypeId<T>}}());}
\DoxyCodeLine{00179\ \ \ \ \ \mbox{\hyperlink{struct_knot_1_1_registry_entry}{RegistryEntry}}\ *entry\ =\ find\_entry(\mbox{\hyperlink{namespace_knot_ade86e03f8ae9230191e43c78f1cfa78e}{TypeId<T>}}());}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{if}\ (!entry)}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00182\ \ \ \ \ \mbox{\hyperlink{struct_knot_1_1_descriptor}{Descriptor}}\ \&desc\ =\ entry-\/>\mbox{\hyperlink{struct_knot_1_1_registry_entry_ab71b1f88abdd60313b12275785647f7f}{desc}};}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keywordflow}{switch}\ (desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a4f391dbbe3f1c713360257fb10d5dfee}{strategy}})\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{_strategy_8hpp_acf7192c608527efb8f8dedf0a3f2e706a57da18394d2f90538c40b0b8d4a3a3c7}{SINGLETON}}:\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a6ff2348022d066f78bcb6dfcae995d10}{instance}})}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a6ff2348022d066f78bcb6dfcae995d10}{instance}}\ =\ desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a8efd47264e3428bfe225edfab3ec4cf7}{factory}}-\/>\mbox{\hyperlink{class_knot_1_1_i_factory_a6fb502f7a93bb39ab1b40089101a24ea}{create}}(desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a3553620e4356d57d1f294449b8ee3f95}{storage}});}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}T\ *\textcolor{keyword}{>}(desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a6ff2348022d066f78bcb6dfcae995d10}{instance}});}
\DoxyCodeLine{00188\ \ \ \ \ \}}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{_strategy_8hpp_acf7192c608527efb8f8dedf0a3f2e706a189628bd9c66ada3fb11593230091ad4}{TRANSIENT}}:\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_transient\_count\ >=\ \mbox{\hyperlink{_container_8hpp_a0be5eb622adb32a42af1bc9a30a6307b}{KNOT\_MAX\_TRANSIENTS}})}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ 0;}
\DoxyCodeLine{00193\ \ \ \ \ \ \ KNOT\_ERR(\textcolor{stringliteral}{"{}Allocating\ transient\ service\ with\ ID:\ \{\}"{}},\ \mbox{\hyperlink{namespace_knot_ade86e03f8ae9230191e43c78f1cfa78e}{TypeId<T>}}());}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *mem\ =\ \_pool.allocate(\textcolor{keyword}{sizeof}(T),\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}\ *),\ \&size);}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!mem)}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00197\ \ \ \ \ \ \ T\ *ptr\ =\ \textcolor{keyword}{static\_cast<}T\ *\textcolor{keyword}{>}(desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a8efd47264e3428bfe225edfab3ec4cf7}{factory}}-\/>\mbox{\hyperlink{class_knot_1_1_i_factory_a6fb502f7a93bb39ab1b40089101a24ea}{create}}(mem));}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \_transients[\_transient\_count].factory\ =\ desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a8efd47264e3428bfe225edfab3ec4cf7}{factory}};}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \_transients[\_transient\_count].ptr\ =\ ptr;}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \_transients[\_transient\_count].alloc\_size\ =\ size;}
\DoxyCodeLine{00201\ \ \ \ \ \ \ ++\_transient\_count;}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ptr;}
\DoxyCodeLine{00203\ \ \ \ \ \}}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00206\ \ \ \ \ \}}
\DoxyCodeLine{00207\ \ \ \}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00212\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_knot_1_1_container_aacd6e366d6f1d452f1a0e41c671f020c}{destroyAllSingletons}}()\ \{}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_service\_count;\ ++i)\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \mbox{\hyperlink{struct_knot_1_1_descriptor}{Descriptor}}\ \&desc\ =\ \_registry[i].desc;}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a4f391dbbe3f1c713360257fb10d5dfee}{strategy}}\ ==\ \mbox{\hyperlink{_strategy_8hpp_acf7192c608527efb8f8dedf0a3f2e706a57da18394d2f90538c40b0b8d4a3a3c7}{SINGLETON}}\ \&\&\ desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a6ff2348022d066f78bcb6dfcae995d10}{instance}})\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a8efd47264e3428bfe225edfab3ec4cf7}{factory}}-\/>\mbox{\hyperlink{class_knot_1_1_i_factory_a4f5e4bafa585c5ecd3f3a92eebfac826}{destroy}}(desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a6ff2348022d066f78bcb6dfcae995d10}{instance}});}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ desc.\mbox{\hyperlink{struct_knot_1_1_descriptor_a6ff2348022d066f78bcb6dfcae995d10}{instance}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00219\ \ \ \ \ \}}
\DoxyCodeLine{00220\ \ \ \}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00225\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_knot_1_1_container_a38a66d665fe8f1fe4c3a5291d7a23d8b}{destroyAllTransients}}()\ \{}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_transient\_count;\ ++i)\ \{}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_transients[i].ptr\ \&\&\ \_transients[i].factory)}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \_transients[i].factory-\/>destroy(\_transients[i].ptr);}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_transients[i].ptr)}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \_pool.deallocate(\_transients[i].ptr,\ \_transients[i].alloc\_size);}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \_transients[i].ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \_transients[i].alloc\_size\ =\ 0;}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \_transients[i].factory\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00234\ \ \ \ \ \}}
\DoxyCodeLine{00235\ \ \ \ \ \_transient\_count\ =\ 0;}
\DoxyCodeLine{00236\ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00246\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_knot_1_1_container_aa0879c9247732c2b809463685fa336f8}{destroyTransient}}(T\ *ptr)\ \{}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_transient\_count;\ ++i)\ \{}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_transients[i].ptr\ ==\ ptr)\ \{}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \_transients[i].factory-\/>destroy(ptr);}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \_pool.deallocate(\_transients[i].ptr,\ \_transients[i].alloc\_size);}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \_transients[i].ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \_transients[i].alloc\_size\ =\ 0;}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \_transients[i].factory\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ i\ +\ 1;\ j\ <\ \_transient\_count;\ ++j)}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \_transients[j\ -\/\ 1]\ =\ \_transients[j];}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ -\/-\/\_transient\_count;}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00259\ \ \ \ \ \}}
\DoxyCodeLine{00260\ \ \ \}}
\DoxyCodeLine{00261\ \};}
\DoxyCodeLine{00262\ \}\ \textcolor{comment}{//\ namespace\ Knot}}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ CONTAINER\_HPP}}

\end{DoxyCode}
